## 正则化项与估计偏差 ##

二分类模型模型将大量不同概率伯努利试验的概率进行了参数化（p(w)）。求解二分类模型的过程，就是寻找在给定训练样本（D）的情况下，最优的参数（w\*）。

### 贝叶斯公式与参数估计法 ###

贝叶斯公式描述两个条件概率间的关系。在二分类问题中，似然函数和后验分布有如下关系  
p(w|D)\*p(D) = p(D|w)\*p(w)，  
其中p(w|D)称为后验分布（下文也会表示为P(w)），p(D|w)称为似然函数（下文也会表示为L(w)），p(w)称为参数w的先验分布。

贝叶斯公式衍生出两种参数估计方法：

- Maximum Likelihood Estimation (MLE): w\* = argmax L(w)
- Maximum a Posteriori Estimation (MAP): w\* = argmax P(w)

MLE可以认为是在均匀先验分布的假设下进行的MAP。

### 二分类模型的求解目标 ###

这里为了推导简单，使用同概率的伯努利实验作为toy model，即对所有样本p(w)都相同。

对于MLE参数估计法，N次伯努利实验得到M次1，最大化的目标函数为
L(w) = p(w)^M \* (1-p(w))^(N-M)  
在拉普拉斯先验分布的情况下，对应L1正则化，N次伯努利实验得到M次1，最大化的目标函数为  
P1(w) = p(w)^M \* (1-p(w))^(N-M) \* exp(-c\*abs(w))  
在高斯先验分布的情况下，对应L2正则化，N次伯努利实验得到M次1，最大化的目标函数为  
P2(w) = p(w)^M \* (1-p(w))^(N-M) \* exp(-c\*w^2)  
其中c为正则化系数。

### MLE的无偏性 ###

MLE的目标函数导数为  
L'(w) = p^(M-1) \* (1-p)^(N-M-1) \* [M\*(1-p(w)) - (N-M)\*p(w)] * p'(w)  
其中p'(w)为p(w)对w的一阶导。

使得L(w)最大的w\*必然满足L'(w) = 0，上式中只有方括号中的表达式可能为0，因此有  
p(w*) = M / N  
反映到实际二分类模型中，就是预测平均分值等于训练样本中正例的比例。

### MAP的有偏性 ###

L1-MAP的目标函数导数为  
P1'(w) = p^(M-1) \* (1-p)^(N-M-1) \* exp(-c\*abs(w)) \* [M\*(1-p(w)) - (N-M)\*p(w) **- c\*p(w)\*(1-p(w))**] 当w > 0时，  
P1'(w) = p^(M-1) \* (1-p)^(N-M-1) \* exp(-c\*abs(w)) \* [M\*(1-p(w)) - (N-M)\*p(w) **+ c\*p(w)\*(1-p(w))**] 当w < 0时，  
当w = 0时，目标函数不可导。

L2-MAP的目标函数导数为
P2'(w) = p^(M-1) \* (1-p)^(N-M-1) \* exp(-c\*w^2) \* [M\*(1-p(w)) - (N-M)\*p(w) **- 2\*c\*w\*p(w)\*(1-p(w))**]

先忽略L1不可导的问题，方括号中的加粗项，使得p(w\*)偏离了M/N，说明L1(2)-MAP都是有偏的，但正则化项控制了MLE中对训练样本的过拟合。

由于L1和L2正则化是通过添加先验分布的方式控制过拟合，导致了估计结果有偏，因此在选用L1和L2正则化的情况下经常需要对输出结果进行校准。